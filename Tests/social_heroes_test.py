import pytest
from bson import ObjectId

from socialHeroes import findSocialHerosBasedOnComments

kafka_social_heroes = {'social_hero_devs': 66, 'total_devs': 4582, 'social_hero_dev_percentage': 1.4404190309908338, 'social_hero_list': {ObjectId('5b10e842328aa9d5312474f4'), ObjectId('59b67b13f5dec65b391cf3d0'), ObjectId('59b68165f2a4565fe9842a1b'), ObjectId('5b0fc400065f3902108de369'), ObjectId('5b11101e328aa9d531380acb'), ObjectId('5b10ea24328aa9d5312e8367'), ObjectId('5b0fc415065f39020f8df682'), ObjectId('5b0fc400065f3902028de380'), ObjectId('5b10efd0328aa9d531de7b13'), ObjectId('5b0fc401065f3902088de3ab'), ObjectId('58c118ea02ca40f8bfb1f2fc'), ObjectId('5b0fc401065f3902088de3aa'), ObjectId('5b0fc400065f3902028de37f'), ObjectId('597ef21fc3b9e78f72df19f2'), ObjectId('5b0fc419065f3902098dfa56'), ObjectId('5b0fc418065f3902048dfa26'), ObjectId('5b0fc40a065f39020d8de915'), ObjectId('58bfce7ce4f89451f55ce12c'), ObjectId('58bfd01e02ca40f8bf14819d'), ObjectId('5b0fc409065f3902108de87c'), ObjectId('5b10ebe7328aa9d5315badd8'), ObjectId('5b0fc400065f3902098de369'), ObjectId('5b10e805328aa9d5312465c0'), ObjectId('5b10e805328aa9d531246675'), ObjectId('5b10eccb328aa9d5317f9839'), ObjectId('58bfcddee4f89451f55ce117'), ObjectId('58bfcc0b02ca40f8bf147cc3'), ObjectId('5b0fc413065f39020a8df1a2'), ObjectId('5b110b17328aa9d531310fdf'), ObjectId('5b0fc40f065f3902088def23'), ObjectId('5b10e9c8328aa9d53125e925'), ObjectId('5b0fc405065f3902128de718'), ObjectId('5b0fc401065f3902118de438'), ObjectId('5b0fc402065f3902088de4a5'), ObjectId('58b938acf04620b371fccf94'), ObjectId('5b0fc423065f39020f8e03b0'), ObjectId('5b0fc40a065f3902028de8d7'), ObjectId('58b938acf04620b370fccf94'), ObjectId('5b0fc400065f3902068de37d'), ObjectId('58bfd08f02ca40f8bf148267'), ObjectId('58bfcef402ca40f8bf147f9e'), ObjectId('5b10ec0a328aa9d53161aee9'), ObjectId('5b0fc400065f39020b8de36a'), ObjectId('5b0fc426065f3902128e0e53'), ObjectId('58bfd36802ca40f8bf14868a'), ObjectId('5b0fc40e065f3902068decaa'), ObjectId('5b0fc401065f3902068de3cf'), ObjectId('5b0fc400065f3902058de369'), ObjectId('5b10ebe9328aa9d5315c36b9'), ObjectId('5b111137328aa9d531383ece'), ObjectId('5b0fc401065f3902078de3ca'), ObjectId('58bfc8ca02ca40f8bf1478c5'), ObjectId('5b0fc41b065f39020d8dfc1a'), ObjectId('5b110d01328aa9d531317255'), ObjectId('5b10e861328aa9d53124a75d'), ObjectId('58bfd16f02ca40f8bf148412'), ObjectId('5b10ee2f328aa9d531a67aa8'), ObjectId('5b0fc415065f3902058df6e4'), ObjectId('5b0fc419065f3902078dfa1d'), ObjectId('58bfca5b02ca40f8bf1479d4'), ObjectId('58c8dda402ca40f8bfbae3f8'), ObjectId('5b0fc400065f3902058de36a'), ObjectId('5b10e81b328aa9d531246b5f'), ObjectId('5b0fc400065f3902048de36a'), ObjectId('5b0fc400065f39020f8de369'), ObjectId('5b0fc413065f3902108df685')}}


@pytest.mark.parametrize("project_name, expected_output", [("kafka", kafka_social_heroes)])
def test_social_heroes(project_name, expected_output):
    assert expected_output == findSocialHerosBasedOnComments(project_name)
