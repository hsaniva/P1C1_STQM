import pytest
from bson import ObjectId

from centralities import eigenVectorCentralityForTechnicalCollab, eigenVectorCentralityForSocialCollab

kafka_eigen_technical_centrality = {ObjectId('636529d6e9a99c9121bc982b'): 0.05, ObjectId('636529d6e9a99c9121bc97fd'): 0.31, ObjectId('636529d6e9a99c9121bc982c'): 0.12, ObjectId('636529d5e9a99c9121bb2f16'): 0.31, ObjectId('636529d6e9a99c9121bb945b'): 0.26, ObjectId('636529d6e9a99c9121bc90f1'): 0.25, ObjectId('636529d6e9a99c9121bbedb5'): 0.23, ObjectId('636529d5e9a99c9121bb43f5'): 0.22, ObjectId('636529d6e9a99c9121bc9108'): 0.25, ObjectId('636529d6e9a99c9121bc92ae'): 0.3, ObjectId('636529d6e9a99c9121bc92a4'): 0.25, ObjectId('636529d6e9a99c9121bc9117'): 0.17, ObjectId('636529d6e9a99c9121bc911b'): 0.23, ObjectId('636529d6e9a99c9121bc9f1a'): 0.19, ObjectId('636529d6e9a99c9121bc9118'): 0.14, ObjectId('636529d6e9a99c9121bc92a5'): 0.17, ObjectId('636529d6e9a99c9121bc9830'): 0.23, ObjectId('636529d6e9a99c9121bc92a1'): 0.06, ObjectId('636529d6e9a99c9121bc9f20'): 0.07, ObjectId('636529d6e9a99c9121bc9831'): 0.15, ObjectId('636529d6e9a99c9121bc9f22'): 0.07, ObjectId('636529d5e9a99c9121bb2774'): 0.14, ObjectId('636529d6e9a99c9121bc5fc9'): 0.16, ObjectId('636529d6e9a99c9121bbb43a'): 0.06, ObjectId('636529d6e9a99c9121bc9f1b'): 0.08, ObjectId('636529d6e9a99c9121bc9114'): 0.07, ObjectId('636529d6e9a99c9121bc9f1f'): 0.15, ObjectId('636529d6e9a99c9121bba37f'): 0.05, ObjectId('636529d6e9a99c9121bc9f21'): 0.07, ObjectId('636529d6e9a99c9121bc9f1e'): 0.06, ObjectId('636529d6e9a99c9121bbcfed'): 0.02}
pig_eigen_technical_centrality = {ObjectId('636529d6e9a99c9121bc4b16'): 0.71, ObjectId('636529d6e9a99c9121bc9efc'): 0.71}
kafka_eigen_social_centrality = {ObjectId('636529d6e9a99c9121bc9118'): 0.11, ObjectId('636529d6e9a99c9121bc97fd'): 0.37, ObjectId('636529d5e9a99c9121bb2f16'): 0.44, ObjectId('636529d6e9a99c9121bb945b'): 0.35, ObjectId('636529d6e9a99c9121bc9831'): 0.15, ObjectId('636529d6e9a99c9121bc911b'): 0.24, ObjectId('636529d6e9a99c9121bc92ae'): 0.35, ObjectId('636529d6e9a99c9121bbedb5'): 0.27, ObjectId('636529d6e9a99c9121bc9108'): 0.2, ObjectId('636529d6e9a99c9121bc5fc9'): 0.23, ObjectId('636529d6e9a99c9121bc90f1'): 0.31, ObjectId('636529d6e9a99c9121bc9117'): 0.11, ObjectId('636529d6e9a99c9121bc92a5'): 0.0, ObjectId('636529d6e9a99c9121bc9830'): 0.0, ObjectId('636529d6e9a99c9121bc9f20'): 0.1, ObjectId('636529d5e9a99c9121bb43f5'): 0.15, ObjectId('636529d6e9a99c9121bbcfed'): 0.0, ObjectId('636529d6e9a99c9121bc9f1a'): 0.06, ObjectId('636529d6e9a99c9121bc9f21'): 0.07, ObjectId('636529d6e9a99c9121bc9f1b'): 0.0, ObjectId('636529d6e9a99c9121bc92a4'): 0.0, ObjectId('636529d5e9a99c9121bb2774'): 0.0, ObjectId('636529d6e9a99c9121bc9114'): 0.15, ObjectId('636529d6e9a99c9121bc9f1e'): 0.0, ObjectId('636529d6e9a99c9121bc982c'): 0.06, ObjectId('636529d6e9a99c9121bbb43a'): 0.0, ObjectId('636529d6e9a99c9121bc92a1'): 0.06, ObjectId('636529d6e9a99c9121bba37f'): 0.0, ObjectId('636529d6e9a99c9121bc9f22'): 0.0, ObjectId('636529d6e9a99c9121bc982b'): 0.0}
pig_eigen_social_centrality = {ObjectId('636529d6e9a99c9121bc9efc'): 0.71, ObjectId('636529d6e9a99c9121bc4b16'): 0.71}


@pytest.mark.parametrize("project_name, expected_output", [("kafka", kafka_eigen_technical_centrality), ("pig", pig_eigen_technical_centrality)])
def test_eigen_centrality_for_technical_colab(project_name, expected_output):
    assert expected_output == eigenVectorCentralityForTechnicalCollab(project_name)


@pytest.mark.parametrize("project_name, expected_output", [("kafka", kafka_eigen_social_centrality), ("pig", pig_eigen_social_centrality)])
def test_eigen_centrality_for_social_colab(project_name, expected_output):
    assert expected_output == eigenVectorCentralityForSocialCollab(project_name)